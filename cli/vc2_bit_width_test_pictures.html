
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>vc2-bit-width-test-pictures &#8212; SMPTE ST 2042-1 (VC-2) Bit Widths 0.1.6 documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="vc2-maximum-quantisation-index" href="vc2_maximum_quantisation_index.html" />
    <link rel="prev" title="vc2-bit-widths-table" href="vc2_bit_widths_table.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="vc2_maximum_quantisation_index.html" title="vc2-maximum-quantisation-index"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="vc2_bit_widths_table.html" title="vc2-bit-widths-table"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">SMPTE ST 2042-1 (VC-2) Bit Widths 0.1.6 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Command-line utilities reference</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><code class="docutils literal notranslate"><span class="pre">vc2-bit-width-test-pictures</span></code></a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <span class="target" id="module-vc2_bit_widths.scripts.vc2_bit_width_test_pictures"></span><div class="section" id="vc2-bit-width-test-pictures">
<span id="id1"></span><h1><code class="docutils literal notranslate"><span class="pre">vc2-bit-width-test-pictures</span></code><a class="headerlink" href="#vc2-bit-width-test-pictures" title="Permalink to this headline">¶</a></h1>
<p>Generate test pictures for VC-2 encoders and decoders which produce extreme
(large-magnitude) signal values.</p>
<div class="section" id="example-usage">
<h2>Example usage<a class="headerlink" href="#example-usage" title="Permalink to this headline">¶</a></h2>
<p>In the example below we generate a series of test pictures for encoders and
decoders which use/expect:</p>
<ul class="simple">
<li><p>2-level 2D LeGall (5, 3) transform</p></li>
<li><p>A particular custom quantisation matrix</p></li>
<li><p>10-bit pictures</p></li>
<li><p>HD (1920x1080) resolution pictures with 4:2:2 colour subsampling</p></li>
</ul>
<p>This tool generates test pictures for a single picture component at a time.
Where picture components have different resolutions (as in this example) the
<code class="docutils literal notranslate"><span class="pre">vc2-bit-width-test-pictures</span></code> command must be used twice.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ vc2-static-filter-analysis \
    --wavelet-index le_gall_5_3 \
    --dwt-depth 2 \
    --output static_analysis.json

$ mkdir luma_test_pictures
$ vc2-bit-width-test-pictures \
    static_analysis.json \
    1920 1080 \
    --picture-bit-width 10 \
    --custom-quantisation-matrix \
        0 LL 1 \
        1 HL 2   1 LH 0   1 HH 4 \
        2 HL 1   2 LH 3   2 HH 3 \
    --output-directory luma_test_pictures

$ mkdir color_diff_test_pictures
$ vc2-bit-width-test-pictures \
    static_analysis.json \
    1920 540 \
    --picture-bit-width 10 \
    --custom-quantisation-matrix \
        0 LL 1 \
        1 HL 2   1 LH 0   1 HH 4 \
        2 HL 1   2 LH 3   2 HH 3 \
    --output-directory color_diff_test_pictures

$ ls luma_test_pictures/
analysis_0.json         synthesis_1_qi35.json   synthesis_6_qi48.json
analysis_0.png          synthesis_1_qi35.png    synthesis_6_qi48.png
synthesis_0_qi34.json   synthesis_2_qi44.json   synthesis_7_qi49.json
synthesis_0_qi34.png    synthesis_2_qi44.png    synthesis_7_qi49.png
synthesis_10_qi52.json  synthesis_3_qi45.json   synthesis_8_qi50.json
synthesis_10_qi52.png   synthesis_3_qi45.png    synthesis_8_qi50.png
synthesis_11_qi54.json  synthesis_4_qi46.json   synthesis_9_qi51.json
synthesis_11_qi54.png   synthesis_4_qi46.png    synthesis_9_qi51.png
synthesis_12_qi58.json  synthesis_5_qi47.json
synthesis_12_qi58.png   synthesis_5_qi47.png
</pre></div>
</div>
<p>The two generated directories containing test pictures suitable for testing the
luminance and colour-difference picture components.</p>
</div>
<div class="section" id="test-picture-format-and-usage">
<span id="vc2-bit-width-test-pictures-format"></span><h2>Test picture format and usage<a class="headerlink" href="#test-picture-format-and-usage" title="Permalink to this headline">¶</a></h2>
<p>The test pictures generated by this software are saved as 8-bit monochrome PNG
images, regardless of the picture bit width specified. These pictures must be
extended to the correct picture bit width before use. The test pictures contain
only black (minimum signal level), mid-gray (0) and white (maximum signal
level) pixels. An example is shown below:</p>
<img alt="../_images/example_test_picture.png" src="../_images/example_test_picture.png" />
<p>Analysis test pictures have names of the form <code class="docutils literal notranslate"><span class="pre">analysis_*.png</span></code>. These must be
presented to an encoder under test and the output validated against a reference
implementation. The results should be comparable with those achieved by the
reference implementation.</p>
<p>Synthesis test pictures have names of the form <code class="docutils literal notranslate"><span class="pre">synthesis_*_qi*.png</span></code>.  These
must first be encoded using an encoder configured to use the quantisation index
given in the filename (after <code class="docutils literal notranslate"><span class="pre">qi</span></code>) for all picture slices. The encoded
pictures must be presented to the decoder under test and compared with a
reference implementation. The results should be bit-for-bit identical.</p>
</div>
<div class="section" id="json-metadata-format">
<h2>JSON metadata format<a class="headerlink" href="#json-metadata-format" title="Permalink to this headline">¶</a></h2>
<p>Each test picture (<code class="docutils literal notranslate"><span class="pre">*.png</span></code>) is accompanied by a JSON metadata file
(<code class="docutils literal notranslate"><span class="pre">*.json</span></code>) with a matching name. This JSON file enumerates the test patterns
contained within the picture and which values within an encoder or decoder
implementation are being targeted.</p>
<p>Each file has the following structure:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;level&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;array_name&quot;</span><span class="p">:</span> <span class="s2">&quot;L&#39;&#39;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;maximise&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
        <span class="s2">&quot;tx&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s2">&quot;ty&quot;</span><span class="p">:</span> <span class="mi">4</span>
    <span class="p">},</span>
    <span class="o">...</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Each object describes a particular test pattern within the picture and its
intended target within the encoder or decoder.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">level</span></code>, <code class="docutils literal notranslate"><span class="pre">array_name</span></code>, <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> values define the specific
filter phase targeted (see <a class="reference internal" href="../introduction/terminology.html#terminology"><span class="std std-ref">Terminology</span></a>).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">maximise</span></code> value is <code class="docutils literal notranslate"><span class="pre">true</span></code> for patterns intended to maximise a signal
value and <code class="docutils literal notranslate"><span class="pre">false</span></code> for those intended to minimise.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">tx</span></code> and <code class="docutils literal notranslate"><span class="pre">ty</span></code> values give the coordinates of the specific value within
the targeted filter array which is being targeted by the pattern.</p>
</div>
<div class="section" id="arguments">
<h2>Arguments<a class="headerlink" href="#arguments" title="Permalink to this headline">¶</a></h2>
<p>The complete set of arguments can be listed using <code class="docutils literal notranslate"><span class="pre">--help</span></code></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>usage: vc2-bit-width-test-pictures [-h]
                                   [--picture-bit-width PICTURE_BIT_WIDTH]
                                   [--custom-quantisation-matrix CUSTOM_QUANTISATION_MATRIX [CUSTOM_QUANTISATION_MATRIX ...]]
                                   [--verbose]
                                   [--output-directory OUTPUT_DIRECTORY]
                                   static_filter_analysis width height
                                   [optimised_synthesis_test_patterns]

Generate test pictures for VC-2 encoders and decoders which produce extreme
(large-magnitude) signal values.

positional arguments:
  static_filter_analysis
                        The static analysis JSON data produced by vc2-static-
                        filter-analysis.
  width                 The width (in samples) of the test pictures to
                        generate.
  height                The height (in samples) of the test pictures to
                        generate.
  optimised_synthesis_test_patterns
                        A set of optimised synthesis test patterns produced by
                        vc2-optimise-synthesis-test-patterns.

optional arguments:
  -h, --help            show this help message and exit
  --picture-bit-width PICTURE_BIT_WIDTH, -b PICTURE_BIT_WIDTH
                        The number of bits in the picture signal.
  --custom-quantisation-matrix CUSTOM_QUANTISATION_MATRIX [CUSTOM_QUANTISATION_MATRIX ...], -q CUSTOM_QUANTISATION_MATRIX [CUSTOM_QUANTISATION_MATRIX ...]
                        Use a custom quantisation matrix. Optional except for
                        filters without a default quantisation matrix defined.
                        Should be specified as a series 3-argument tuples
                        giving the level, orientation and quantisation matrix
                        value for every entry in the quantisation matrix.
  --verbose, -v         Show more detailed status information during
                        execution.
  --output-directory OUTPUT_DIRECTORY, --output OUTPUT_DIRECTORY, -o OUTPUT_DIRECTORY
                        The name of the directory to write the generated test
                        patterns and metadata files to. Must already exist.
                        Existing files will be overwitten. (Default: .).
</pre></div>
</div>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#"><code class="docutils literal notranslate"><span class="pre">vc2-bit-width-test-pictures</span></code></a><ul>
<li><a class="reference internal" href="#example-usage">Example usage</a></li>
<li><a class="reference internal" href="#test-picture-format-and-usage">Test picture format and usage</a></li>
<li><a class="reference internal" href="#json-metadata-format">JSON metadata format</a></li>
<li><a class="reference internal" href="#arguments">Arguments</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="vc2_bit_widths_table.html"
                        title="previous chapter"><code class="docutils literal notranslate"><span class="pre">vc2-bit-widths-table</span></code></a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="vc2_maximum_quantisation_index.html"
                        title="next chapter"><code class="docutils literal notranslate"><span class="pre">vc2-maximum-quantisation-index</span></code></a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/cli/vc2_bit_width_test_pictures.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="vc2_maximum_quantisation_index.html" title="vc2-maximum-quantisation-index"
             >next</a> |</li>
        <li class="right" >
          <a href="vc2_bit_widths_table.html" title="vc2-bit-widths-table"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">SMPTE ST 2042-1 (VC-2) Bit Widths 0.1.6 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Command-line utilities reference</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><code class="docutils literal notranslate"><span class="pre">vc2-bit-width-test-pictures</span></code></a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, BBC.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.5.2.
    </div>
  </body>
</html>